<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZEGXXZQXN2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZEGXXZQXN2');
  </script>
  <title>Covid Tracker</title>
  <style>
    * {
      background-color: aliceblue;
    }
    #data {
      font-size: 24px;
    }
    td {
      border: 1px solid green;
      padding: 5px;
      text-align: center;
    }
    .button {
      margin: 15px 10px 15px 10px;
      display: inline-block;
      padding: 15px;
      border: 1px solid green;
      font-weight: bold;
    }
    #footer {
      margin-bottom: 25px;
    }
  </style>
</head>
<body>
  <h1>Covid Tracker</h1>
  <h2>Data provided by The Covid Data Project</h2>
  <h4><a href="https://covidtracking.com/api" target="_blank">https://covidtracking.com/api</a></h4>

  <div id='NY' class='button'>
    NY
  </div>
  <div id='NJ' class='button'>
    NJ
  </div>
  <div id='IL' class='button'>
    IL
  </div>
  <div id='CA' class='button'>
    CA
  </div>
  <div id='FL' class='button'>
    FL
  </div>
  <div id='IN' class='button'>
    IN
  </div>
  <div id='TX' class='button'>
    TX
  </div>
  <div id='HI' class='button'>
    HI
  </div>
  <table id="data">
  <table>
  <div id='footer'>
    <h3>Who put this simple page together? Have a dev project you need help with? Click below</h3>
    <h3><a href="https://www.kenguie.com" target="_blank">Who's Ken G?</a></h3>
  </div>
  <script>
    let theState = 'NY';
    fetchData(theState);
    document.getElementById('NY').addEventListener('click', 
      function assignState() {
        theState = 'NY';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('NJ').addEventListener('click', 
      function assignState() {
        theState = 'NJ';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('IL').addEventListener('click', 
      function assignState() {
        theState = 'IL';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('CA').addEventListener('click', 
      function assignState() {
        theState = 'CA';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('FL').addEventListener('click', 
      function assignState() {
        theState = 'FL';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('IN').addEventListener('click', 
      function assignState() {
        theState = 'IN';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('TX').addEventListener('click', 
      function assignState() {
        theState = 'TX';
        console.log(theState)
        fetchData(theState);
      }
    );
    document.getElementById('HI').addEventListener('click', 
      function assignState() {
        theState = 'HI';
        console.log(theState)
        fetchData(theState);
      }
    );

    function fetchData(theState) {
      fetch('https://covidtracking.com/api/v1/states/daily.json')
      .then((response) => {
        return response.json();
      })
      .then((datas) => {
        const stateData = datas.filter((data) => {
          return data.state === theState;
        })
        console.log(stateData);
        const table = document.getElementById("data");
        const headerRow = table.insertRow(0);
        const h1 = headerRow.insertCell(0);
        const h2 = headerRow.insertCell(1);
        const h3 = headerRow.insertCell(2);
        const h4 = headerRow.insertCell(3);
        const h5 = headerRow.insertCell(4);
        const h6 = headerRow.insertCell(5);
        const h7 = headerRow.insertCell(6);
        h1.innerHTML = 'date';
        h2.innerHTML = 'state';
        h3.innerHTML = 'total';
        h4.innerHTML = 'hospitalizedCurrently';
        h5.innerHTML = 'hospitalizedIncrease';
        h6.innerHTML = 'death';
        h7.innerHTML = 'deathIncrease';

        stateData.forEach((data, index) => {
          const table = document.getElementById("data");
          const row = table.insertRow(index+1);
          const c1 = row.insertCell(0);
          const c2 = row.insertCell(1);
          const c3 = row.insertCell(2);
          const c4 = row.insertCell(3);
          const c5 = row.insertCell(4);
          const c6 = row.insertCell(5);
          const c7 = row.insertCell(6);
          c1.innerHTML = data.date;
          c2.innerHTML = data.state;
          c3.innerHTML = data.total;
          c4.innerHTML = data.hospitalizedCurrently;
          c5.innerHTML = data.hospitalizedIncrease;
          c6.innerHTML = data.death;
          c7.innerHTML = data.deathIncrease;
        })
      });
    }
  </script>
</body>
</html>
